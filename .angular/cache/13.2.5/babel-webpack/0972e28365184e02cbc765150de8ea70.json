{"ast":null,"code":"import { Validators } from '@angular/forms';\nimport { environment } from '../../../environments/environment';\nimport Swal from 'sweetalert2';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"src/app/services/validatorRegistro.service\";\nimport * as i3 from \"src/app/services/register.service\";\nimport * as i4 from \"@angular/common/http\";\nimport * as i5 from \"@angular/router\";\nimport * as i6 from \"@angular/common\";\n\nfunction MiPerfilComponent_span_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 27);\n    i0.ɵɵtext(1, \" Solo letras \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction MiPerfilComponent_span_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 27);\n    i0.ɵɵtext(1, \" Debes introducir dos apellidos \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction MiPerfilComponent_span_20_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 27);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.emailErrorMsg, \" \");\n  }\n}\n\nfunction MiPerfilComponent_span_23_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 27);\n    i0.ɵɵtext(1, \" Deben ser 9 d\\u00EDgitos. \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction MiPerfilComponent_span_26_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 27);\n    i0.ɵɵtext(1, \" La contrase\\u00F1a debe de ser mayor de 6 caracteres. \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction MiPerfilComponent_span_29_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 27);\n    i0.ɵɵtext(1, \" Las contrase\\u00F1as deben de ser iguales \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction MiPerfilComponent_span_34_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 27);\n    i0.ɵɵtext(1, \" La direcci\\u00F3n es requerida \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nexport let MiPerfilComponent = /*#__PURE__*/(() => {\n  class MiPerfilComponent {\n    constructor(fb, ValidatorRegistroService, registerService, http, router) {\n      this.fb = fb;\n      this.ValidatorRegistroService = ValidatorRegistroService;\n      this.registerService = registerService;\n      this.http = http;\n      this.router = router;\n      this.miFormulario = this.fb.group({\n        email: ['', [Validators.required, Validators.pattern(this.ValidatorRegistroService.emailPattern)], [this.ValidatorRegistroService]],\n        password: ['', [Validators.required, Validators.minLength(6)]],\n        password2: ['', [Validators.required]],\n        apellidos: ['', [Validators.required, Validators.pattern(this.ValidatorRegistroService.apellidosPattern)]],\n        direccion: ['', [Validators.required]],\n        nombre: ['', [Validators.required, Validators.pattern(this.ValidatorRegistroService.nombrePattern)]],\n        nacimiento: ['', [Validators.required]],\n        telefono: ['', [Validators.required, Validators.pattern(this.ValidatorRegistroService.telefonoPattern)]]\n      }, {\n        validators: [this.ValidatorRegistroService.camposIguales('password', 'password2') // , this.validatorService.validarEmail('email')\n        ]\n      });\n      this.solucion = \"\";\n      this.baseUrl = environment.baseUrl;\n    }\n\n    get emailErrorMsg() {\n      var _a;\n\n      const errors = (_a = this.miFormulario.get('email')) === null || _a === void 0 ? void 0 : _a.errors;\n\n      if (errors['required']) {\n        return 'Email es obligatorio';\n      } else if (errors['pattern']) {\n        return 'El valor ingresado no tiene formato de correo';\n      } else if (errors['emailTomado']) {\n        return 'El email ya está en uso';\n      }\n\n      return '';\n    }\n\n    ngOnInit() {\n      this.miFormulario.reset({\n        email: '',\n        password: '',\n        password2: '',\n        apellidos: '',\n        direccion: '',\n        nacimietno: ''\n      });\n    }\n\n    campoNoValido(campo) {\n      var _a, _b; // this.findInvalidControlsRecursive(this.miFormulario);\n\n\n      return ((_a = this.miFormulario.get(campo)) === null || _a === void 0 ? void 0 : _a.invalid) && ((_b = this.miFormulario.get(campo)) === null || _b === void 0 ? void 0 : _b.touched);\n    }\n    /**\n     * Metodo para ver donde falla el formulario\n     */\n    // public findInvalidControlsRecursive(formToInvestigate:FormGroup|FormArray):string[] {\n    //   var invalidControls:string[] = [];\n    //   let recursiveFunc = (form:FormGroup|FormArray) => {\n    //     Object.keys(form.controls).forEach(field => { \n    //       const control = form.get(field);\n    //       if (control?.invalid) invalidControls.push(field);\n    //       if (control instanceof FormGroup) {\n    //         recursiveFunc(control);\n    //       } else if (control instanceof FormArray) {\n    //         recursiveFunc(control);\n    //       }        \n    //     });\n    //   }\n    //   recursiveFunc(formToInvestigate);\n    //   console.log(invalidControls)\n    //   console.log(this.miFormulario.valid + \"gfgdfgdgdfgfdgfdgdfg\")\n    //   return invalidControls;\n    // }\n\n\n    submitFormulario() {\n      this.register();\n      this.miFormulario.markAllAsTouched();\n    }\n\n    comprobarRespuestaLogin() {\n      if (this.solucion == \"true\") {} else if (this.solucion == \"incorrect\") {} else {}\n    }\n    /**\n     * Este metodo recibira un usuario del formulario y llamara\n     * a registerService para realizar una peticion post de añadir\n     * el usuario\n     */\n\n\n    register() {\n      var _a, _b, _c, _d, _e, _f, _g;\n\n      let respuesta = {};\n      let solucion;\n      const user = {\n        \"email\": (_a = this.miFormulario.get(\"email\")) === null || _a === void 0 ? void 0 : _a.value,\n        \"password\": (_b = this.miFormulario.get(\"password\")) === null || _b === void 0 ? void 0 : _b.value,\n        \"nombre\": (_c = this.miFormulario.get(\"nombre\")) === null || _c === void 0 ? void 0 : _c.value,\n        \"apellidos\": (_d = this.miFormulario.get(\"apellidos\")) === null || _d === void 0 ? void 0 : _d.value,\n        \"telefono\": (_e = this.miFormulario.get(\"telefono\")) === null || _e === void 0 ? void 0 : _e.value,\n        \"ubicacion\": (_f = this.miFormulario.get(\"direccion\")) === null || _f === void 0 ? void 0 : _f.value,\n        \"fechaNacimiento\": (_g = this.miFormulario.get(\"nacimiento\")) === null || _g === void 0 ? void 0 : _g.value\n      };\n      this.registerService.register(user).subscribe({\n        next: resp => {\n          respuesta = resp;\n\n          if (respuesta.jwt_token != null) {\n            localStorage.setItem('jwt', respuesta.jwt_token);\n            this.router.navigate(['home']);\n            solucion = \"true\";\n          }\n        },\n\n        error(error) {\n          solucion = \"error\";\n          localStorage.removeItem('jwt');\n          Swal.fire({\n            title: 'Error al inciar sesión',\n            text: 'Vuelve a intentarlo',\n            icon: 'error',\n            confirmButtonText: 'Ok'\n          });\n        }\n\n      });\n    }\n\n  }\n\n  MiPerfilComponent.ɵfac = function MiPerfilComponent_Factory(t) {\n    return new (t || MiPerfilComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.ValidatorRegistroService), i0.ɵɵdirectiveInject(i3.RegisterService), i0.ɵɵdirectiveInject(i4.HttpClient), i0.ɵɵdirectiveInject(i5.Router));\n  };\n\n  MiPerfilComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: MiPerfilComponent,\n    selectors: [[\"app-mi-perfil\"]],\n    decls: 39,\n    vars: 8,\n    consts: [[1, \"vh-75\"], [1, \"py-1\", \"h-75\"], [1, \"row\", \"d-flex\", \"justify-content-center\", \"align-items-center\", \"h-75\", \"w-100\", \"ms-auto\", \"me-auto\"], [1, \"col-12\", \"col-sm-12\", \"col-md-8\", \"col-lg-11\", \"col-xl-10\"], [1, \"card\", \"shadow-2-strong\", \"border-3\", \"d-flex\", 2, \"border-radius\", \"1rem\"], [1, \"card-body\", \"p-5\", \"text-center\", \"row\", \"row-cols-sm-1\", \"row-cols-md.2\", \"row-cols-lg-2\", \"w-100\", \"justify-content-center\"], [1, \"col\", \"w-25\"], [1, \"p-3\"], [\"src\", \"https://cdn.computerhoy.com/sites/navi.axelspringer.es/public/styles/1200/public/media/image/2018/08/fotos-perfil-whatsapp_16.jpg?itok=fl2H3Opv\", \"alt\", \"foto de perfil\", 1, \"img-fluid\", \"rounded-circle\"], [\"href\", \"#\", 1, \"btn\", \"btn-success\"], [\"autocomplete\", \"off\", 1, \"row\", \"g-3\", 3, \"formGroup\", \"ngSubmit\"], [1, \"col-md-4\"], [\"type\", \"text\", \"formControlName\", \"nombre\", \"placeholder\", \"Nombre\", 1, \"form-control\"], [\"class\", \"form-text text-danger\", 4, \"ngIf\"], [1, \"col-md-8\"], [\"type\", \"text\", \"formControlName\", \"apellidos\", \"placeholder\", \"Apellidos\", 1, \"form-control\"], [\"type\", \"email\", \"formControlName\", \"email\", \"placeholder\", \"Email\", 1, \"form-control\"], [\"type\", \"text\", \"formControlName\", \"telefono\", \"placeholder\", \"Tel\\u00E9fono\", 1, \"form-control\"], [1, \"col-md-6\"], [\"type\", \"password\", \"formControlName\", \"password\", \"placeholder\", \"Contrase\\u00F1a\", 1, \"form-control\"], [\"type\", \"password\", \"formControlName\", \"password2\", \"placeholder\", \"Confirma contrase\\u00F1a\", 1, \"form-control\"], [1, \"col-md-8\", \"text-start\"], [\"for\", \"inputEmail4\", 1, \"form-label\", \"ms-2\"], [\"type\", \"text\", \"formControlName\", \"direccion\", \"placeholder\", \"Direcci\\u00F3n\", 1, \"form-control\"], [1, \"col-md-4\", \"text-start\"], [\"for\", \"inputPassword4\", 1, \"form-label\", \"ms-2\"], [\"type\", \"date\", \"formControlName\", \"nacimiento\", 1, \"form-control\"], [1, \"form-text\", \"text-danger\"]],\n    template: function MiPerfilComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"section\", 0);\n        i0.ɵɵelementStart(1, \"div\", 1);\n        i0.ɵɵelementStart(2, \"div\", 2);\n        i0.ɵɵelementStart(3, \"div\", 3);\n        i0.ɵɵelementStart(4, \"div\", 4);\n        i0.ɵɵelementStart(5, \"div\", 5);\n        i0.ɵɵelementStart(6, \"div\", 6);\n        i0.ɵɵelementStart(7, \"div\", 7);\n        i0.ɵɵelement(8, \"img\", 8);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(9, \"a\", 9);\n        i0.ɵɵtext(10, \"Cambiar foto\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(11, \"form\", 10);\n        i0.ɵɵlistener(\"ngSubmit\", function MiPerfilComponent_Template_form_ngSubmit_11_listener() {\n          return ctx.submitFormulario();\n        });\n        i0.ɵɵelementStart(12, \"div\", 11);\n        i0.ɵɵelement(13, \"input\", 12);\n        i0.ɵɵtemplate(14, MiPerfilComponent_span_14_Template, 2, 0, \"span\", 13);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(15, \"div\", 14);\n        i0.ɵɵelement(16, \"input\", 15);\n        i0.ɵɵtemplate(17, MiPerfilComponent_span_17_Template, 2, 0, \"span\", 13);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(18, \"div\", 14);\n        i0.ɵɵelement(19, \"input\", 16);\n        i0.ɵɵtemplate(20, MiPerfilComponent_span_20_Template, 2, 1, \"span\", 13);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(21, \"div\", 11);\n        i0.ɵɵelement(22, \"input\", 17);\n        i0.ɵɵtemplate(23, MiPerfilComponent_span_23_Template, 2, 0, \"span\", 13);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(24, \"div\", 18);\n        i0.ɵɵelement(25, \"input\", 19);\n        i0.ɵɵtemplate(26, MiPerfilComponent_span_26_Template, 2, 0, \"span\", 13);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(27, \"div\", 18);\n        i0.ɵɵelement(28, \"input\", 20);\n        i0.ɵɵtemplate(29, MiPerfilComponent_span_29_Template, 2, 0, \"span\", 13);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(30, \"div\", 21);\n        i0.ɵɵelementStart(31, \"label\", 22);\n        i0.ɵɵtext(32, \"Direcci\\u00F3n por defecto\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(33, \"input\", 23);\n        i0.ɵɵtemplate(34, MiPerfilComponent_span_34_Template, 2, 0, \"span\", 13);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(35, \"div\", 24);\n        i0.ɵɵelementStart(36, \"label\", 25);\n        i0.ɵɵtext(37, \"Nacimiento\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(38, \"input\", 26);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(11);\n        i0.ɵɵproperty(\"formGroup\", ctx.miFormulario);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngIf\", ctx.campoNoValido(\"nombre\"));\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngIf\", ctx.campoNoValido(\"apellidos\"));\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngIf\", ctx.campoNoValido(\"email\"));\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngIf\", ctx.campoNoValido(\"telefono\"));\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngIf\", ctx.campoNoValido(\"password\"));\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngIf\", ctx.campoNoValido(\"password2\"));\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngIf\", ctx.campoNoValido(\"direccion\"));\n      }\n    },\n    directives: [i1.ɵNgNoValidate, i1.NgControlStatusGroup, i1.FormGroupDirective, i1.DefaultValueAccessor, i1.NgControlStatus, i1.FormControlName, i6.NgIf],\n    styles: [\"\"]\n  });\n  return MiPerfilComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}